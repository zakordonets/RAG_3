#!/usr/bin/env python3
"""
–û—Ç–ª–∞–¥–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞ Jina Reader
"""

import sys
from pathlib import Path
sys.path.append(str(Path(__file__).parent.parent))

from ingestion.parsers import parse_jina_content


def test_parser():
    """–¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""

    # –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç Jina Reader
    jina_content = """Title: –ß—Ç–æ —Ç–∞–∫–æ–µ edna Chat Center | edna Chat Center

URL Source: http://docs-chatcenter.edna.ru/docs/start/whatis

Markdown Content:
–û–±–Ω–æ–≤–ª–µ–Ω–æ:

24 –∏—é–ª—è 2024

edna Chat Center ‚Äî —ç—Ç–æ –≥–∏–±–∫–æ–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–º–æ–≥–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ –Ω–µ–≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –≤ –µ–¥–∏–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –¢–∞–∫–∂–µ edna Chat Center –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –ø—Ä–æ–¥–∞–∂ —Ç–∏–ø–∞ CRM –∏ HelpDesk, —Å–∏—Å—Ç–µ–º–∞–º–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏, —á–∞—Ç-–±–æ—Ç–∞–º–∏, –∏ –ª–µ–≥–∫–æ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ IT-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

## –ß—Ç–æ —Ç–∞–∫–æ–µ edna Chat Center

edna Chat Center ‚Äî —ç—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–Ω–æ–≥–æ–∫–∞–Ω–∞–ª—å–Ω—ã–º–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º–∏ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —Å–≤—è–∑–∏ –≤ –µ–¥–∏–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–Ω–æ–≥–æ–∫–∞–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤ –∏ –∫–∞–Ω–∞–ª–æ–≤ —Å–≤—è–∑–∏
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –∫–∞–Ω–∞–ª–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–∞–Ω–∞–ª—ã

–í edna Chat Center –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∫–∞–Ω–∞–ª—ã:

1. **Telegram** - –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä
2. **WhatsApp** - –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä
3. **Viber** - –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∑–≤–æ–Ω–∫–æ–≤
4. **–ê–≤–∏—Ç–æ** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π
5. **–í–µ–±-–≤–∏–¥–∂–µ—Ç** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —á–∞—Ç –Ω–∞ —Å–∞–π—Ç–µ
6. **–ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - iOS –∏ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""

    print("üîç –¢–ï–°–¢ –ü–ê–†–°–ï–†–ê JINA READER")
    print("=" * 50)

    print(f"üìÑ –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç:")
    print(f"   –î–ª–∏–Ω–∞: {len(jina_content)} —Å–∏–º–≤–æ–ª–æ–≤")
    print(f"   –ü–µ—Ä–≤—ã–µ 300 —Å–∏–º–≤–æ–ª–æ–≤:")
    print(f"   {jina_content[:300]}...")

    print(f"\nüîß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞:")

    # –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–∞—Ä—Å–µ—Ä
    result = parse_jina_content(jina_content)

    print(f"üìù –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞:")
    print(f"   –ó–∞–≥–æ–ª–æ–≤–æ–∫: '{result['title']}'")
    print(f"   –¢–µ–∫—Å—Ç: {len(result['content'])} —Å–∏–º–≤–æ–ª–æ–≤")

    if result['content']:
        print(f"   ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç!")
        print(f"   –ü–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–∫—Å—Ç–∞:")
        print(f"   {result['content'][:200]}...")
    else:
        print(f"   ‚ùå –¢–µ–∫—Å—Ç –ø—É—Å—Ç–æ–π!")

        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
        print(f"\nüîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:")
        lines = jina_content.split('\n')
        print(f"   –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫: {len(lines)}")

        for i, line in enumerate(lines[:10]):
            print(f"   –°—Ç—Ä–æ–∫–∞ {i+1}: '{line}'")

        # –ò—â–µ–º "Markdown Content:"
        markdown_start = -1
        for i, line in enumerate(lines):
            if line.startswith("Markdown Content:"):
                markdown_start = i
                print(f"   ‚úÖ –ù–∞–π–¥–µ–Ω–∞ 'Markdown Content:' –Ω–∞ —Å—Ç—Ä–æ–∫–µ {i+1}")
                break

        if markdown_start >= 0:
            print(f"   –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ—Å–ª–µ 'Markdown Content:':")
            for i in range(markdown_start + 1, min(markdown_start + 6, len(lines))):
                print(f"     –°—Ç—Ä–æ–∫–∞ {i+1}: '{lines[i]}'")


if __name__ == "__main__":
    test_parser()

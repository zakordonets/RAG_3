# Grafana Quality Dashboard

## –û–±–∑–æ—Ä

Grafana Quality Dashboard –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ RAGAS —Å–∏—Å—Ç–µ–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. Dashboard –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∏–¥–±–µ–∫ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞.

## –î–æ—Å—Ç—É–ø –∫ Dashboard

- **URL**: http://localhost:8080
- **Login**: admin
- **Password**: admin
- **Dashboard**: RAG Quality Metrics Dashboard

## –ü–∞–Ω–µ–ª–∏ Dashboard

### 1. RAGAS Quality Scores
- **–¢–∏–ø**: Time Series
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—Ü–µ–Ω–∫–∏ RAGAS –º–µ—Ç—Ä–∏–∫ (faithfulness, context_precision, answer_relevancy) –≤–æ –≤—Ä–µ–º–µ–Ω–∏
- **–ú–µ—Ç—Ä–∏–∫–∞**: `rag_ragas_score`
- **–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞**: –†–∞–∑–ª–∏—á–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–∏

### 2. User Feedback Distribution
- **–¢–∏–ø**: Pie Chart
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ñ–∏–¥–±–µ–∫–∞ (positive/negative)
- **–ú–µ—Ç—Ä–∏–∫–∞**: `rag_quality_interactions_total{interaction_type="user_feedback"}`
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### 3. Combined Quality Score Over Time
- **–¢–∏–ø**: Time Series
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (RAGAS + –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∏–¥–±–µ–∫)
- **–ú–µ—Ç—Ä–∏–∫–∞**: `rag_combined_quality_score`
- **–ï–¥–∏–Ω–∏—Ü—ã**: –ü—Ä–æ—Ü–µ–Ω—Ç—ã (0-1)

### 4. Quality Interactions Rate
- **–¢–∏–ø**: Time Series
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∫–æ—Ä–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è quality interactions –ø–æ –∫–∞–Ω–∞–ª–∞–º
- **–ú–µ—Ç—Ä–∏–∫–∞**: `rate(rag_quality_interactions_total[5m])`
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞**: –ü–æ –∫–∞–Ω–∞–ª–∞–º (telegram, api, web)

### 5. Quality Evaluation Duration
- **–¢–∏–ø**: Time Series
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- **–ú–µ—Ç—Ä–∏–∫–∞**: `rag_quality_evaluation_duration_seconds`
- **–ï–¥–∏–Ω–∏—Ü—ã**: –°–µ–∫—É–Ω–¥—ã

### 6. Total RAGAS Evaluations (Stat)
- **–¢–∏–ø**: Stat
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ RAGAS –æ—Ü–µ–Ω–æ–∫
- **–ú–µ—Ç—Ä–∏–∫–∞**: `sum(rag_quality_interactions_total{interaction_type="ragas_evaluation"})`

### 7. Total User Feedback (Stat)
- **–¢–∏–ø**: Stat
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ñ–∏–¥–±–µ–∫–∞
- **–ú–µ—Ç—Ä–∏–∫–∞**: `sum(rag_quality_interactions_total{interaction_type="user_feedback"})`

### 8. Current Quality Score (Stat)
- **–¢–∏–ø**: Stat
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–µ–∫—É—â–∞—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
- **–ú–µ—Ç—Ä–∏–∫–∞**: `rag_combined_quality_score{period="current"}`
- **–ï–¥–∏–Ω–∏—Ü—ã**: –ü—Ä–æ—Ü–µ–Ω—Ç—ã

### 9. Avg RAGAS Evaluation Time (Stat)
- **–¢–∏–ø**: Stat
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è RAGAS –æ—Ü–µ–Ω–∫–∏
- **–ú–µ—Ç—Ä–∏–∫–∞**: `rag_quality_evaluation_duration_seconds{evaluation_type="ragas"}`
- **–ï–¥–∏–Ω–∏—Ü—ã**: –°–µ–∫—É–Ω–¥—ã

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Dashboard

### –í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: –ü–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
- **–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø—Ü–∏–∏**: 5 –º–∏–Ω—É—Ç, 15 –º–∏–Ω—É—Ç, 1 —á–∞—Å, 6 —á–∞—Å–æ–≤, 12 —á–∞—Å–æ–≤, 24 —á–∞—Å–∞, 7 –¥–Ω–µ–π, 30 –¥–Ω–µ–π

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **–ß–∞—Å—Ç–æ—Ç–∞**: 30 —Å–µ–∫—É–Ω–¥
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –í–∫–ª—é—á–µ–Ω–æ

### –§–∏–ª—å—Ç—Ä—ã
- **–ö–∞–Ω–∞–ª—ã**: telegram, api, web
- **–¢–∏–ø—ã interactions**: ragas_evaluation, user_feedback
- **–ö–∞—á–µ—Å—Ç–≤–æ**: positive, negative, unknown

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### RAGAS Scores
- **Faithfulness**: –ù–∞—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (0-1)
- **Context Precision**: –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (0-1)
- **Answer Relevancy**: –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –∑–∞–ø—Ä–æ—Å—É (0-1)

### User Feedback
- **Positive**: üëç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–≤–æ–ª–µ–Ω –æ—Ç–≤–µ—Ç–æ–º
- **Negative**: üëé –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ–¥–æ–≤–æ–ª–µ–Ω –æ—Ç–≤–µ—Ç–æ–º

### Combined Quality Score
- **–í—ã—Å–æ–∫–∏–π (>0.8)**: –û—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- **–°—Ä–µ–¥–Ω–∏–π (0.6-0.8)**: –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- **–ù–∏–∑–∫–∏–π (<0.6)**: –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è

## –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∞–ª–µ—Ä—Ç—ã
1. **Low Quality Score**: `rag_combined_quality_score < 0.6`
2. **High Evaluation Time**: `rag_quality_evaluation_duration_seconds > 30`
3. **Low User Satisfaction**: `rag_user_satisfaction_rate < 0.5`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Alerting" –≤ Grafana
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π alert rule
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É—Å–ª–æ–≤–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ dashboard
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
   - `ENABLE_RAGAS_EVALUATION=true`
   - `QUALITY_DB_ENABLED=true`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Prometheus targets: http://localhost:9090/targets

### –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ API —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–∑–∞–ø—Ä–æ—Å—ã –∫ —Å–∏—Å—Ç–µ–º–µ)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞—á–µ—Å—Ç–≤–∞

### Dashboard –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Grafana –∑–∞–ø—É—â–µ–Ω: http://localhost:8080
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Prometheus datasource –Ω–∞—Å—Ç—Ä–æ–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Grafana: `docker logs rag-grafana`

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **Prometheus**: http://localhost:9090
- **API Metrics**: http://localhost:9002/metrics
- **Quality Database**: SQLite (data/quality_interactions.db)

### –ú–µ—Ç—Ä–∏–∫–∏
- **rag_ragas_score**: –û—Ü–µ–Ω–∫–∏ RAGAS –º–µ—Ç—Ä–∏–∫
- **rag_quality_interactions_total**: –°—á–µ—Ç—á–∏–∫–∏ interactions
- **rag_combined_quality_score**: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **rag_quality_evaluation_duration_seconds**: –í—Ä–µ–º—è –æ—Ü–µ–Ω–∫–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: 15 –¥–Ω–µ–π –≤ Prometheus
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ 1000 interactions/—á–∞—Å

# Grafana Quality Dashboard

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ RAG-—Å–∏—Å—Ç–µ–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–í–µ—Ä—Å–∏—è**: 1.0
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 9 –æ–∫—Ç—è–±—Ä—è 2024

---

## üìñ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–î–æ—Å—Ç—É–ø](#–¥–æ—Å—Ç—É–ø-–∫-dashboard)
- [–ü–∞–Ω–µ–ª–∏](#–ø–∞–Ω–µ–ª–∏-dashboard)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-dashboard)
- [–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è](#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö)
- [–ê–ª–µ—Ä—Ç—ã](#–∞–ª–µ—Ä—Ç—ã-–∏-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
- [Troubleshooting](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)

---

## –û–±–∑–æ—Ä

Grafana Quality Dashboard –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞:

- ‚úÖ **RAGAS –º–µ—Ç—Ä–∏–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (faithfulness, precision, relevancy)
- ‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∏–¥–±–µ–∫** - –æ—Ü–µ–Ω–∫–∏ üëç/üëé –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π score** - –æ–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
- ‚úÖ **Performance** - –≤—Ä–µ–º—è –æ—Ü–µ–Ω–∫–∏, throughput
- ‚úÖ **Real-time** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤ production
- –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
- –í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∫–∞—á–µ—Å—Ç–≤–æ–º
- A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –û—Ç—á–µ—Ç—ã –¥–ª—è —Å—Ç–µ–π–∫—Ö–æ–ª–¥–µ—Ä–æ–≤

---

## –î–æ—Å—Ç—É–ø –∫ Dashboard

### –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø

```
URL:      http://localhost:8080
Login:    admin
Password: admin123
Dashboard: RAG Quality Metrics
```

### –ù–∞–≤–∏–≥–∞—Ü–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ Grafana: http://localhost:8080
2. –í–æ–π–¥–∏—Ç–µ (admin / admin123)
3. –ú–µ–Ω—é ‚Üí Dashboards ‚Üí Browse
4. –í—ã–±–µ—Ä–∏—Ç–µ **RAG Quality Metrics Dashboard**

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**: RAG API –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã.

---

## –ü–∞–Ω–µ–ª–∏ Dashboard

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ (Time Series)

#### 1. RAGAS Quality Scores
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–¢–∏–ø** | Time Series (3 –ª–∏–Ω–∏–∏) |
| **–ú–µ—Ç—Ä–∏–∫–∏** | faithfulness, context_precision, answer_relevancy |
| **PromQL** | `ragas_score{metric_type=~"faithfulness\|context_precision\|answer_relevancy"}` |
| **–î–∏–∞–ø–∞–∑–æ–Ω** | 0.0 - 1.0 |

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**:
- –ó–Ω–∞—á–µ–Ω–∏—è > 0.8 - –æ—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- –ó–Ω–∞—á–µ–Ω–∏—è 0.6-0.8 - —Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- –ó–Ω–∞—á–µ–Ω–∏—è < 0.6 - —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

#### 2. Combined Quality Score
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–¢–∏–ø** | Time Series |
| **–§–æ—Ä–º—É–ª–∞** | RAGAS + User Feedback |
| **PromQL** | `rag_combined_quality_score` |
| **Threshold** | Warning < 0.6, Critical < 0.5 |

#### 3. Quality Interactions Rate
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ß–∞—Å—Ç–æ—Ç–∞ –æ—Ü–µ–Ω–æ–∫ –∫–∞—á–µ—Å—Ç–≤–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–¢–∏–ø** | Time Series (–ø–æ –∫–∞–Ω–∞–ª–∞–º) |
| **PromQL** | `rate(rag_quality_interactions_total[5m])` |
| **Group By** | channel (telegram, api, web) |

#### 4. Evaluation Duration
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–¢–∏–ø** | Time Series |
| **–ú–µ—Ç—Ä–∏–∫–∞** | `quality_evaluation_duration_seconds` |
| **Unit** | seconds |
| **Threshold** | > 5s —Ç—Ä–µ–±—É–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ |

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (Stats)

#### 5. Current Quality Score
**–ë–æ–ª—å—à–∞—è —Ü–∏—Ñ—Ä–∞**: –¢–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (0-1)

```promql
rag_combined_quality_score{period="current"}
```

#### 6. Total RAGAS Evaluations
**–°—á–µ—Ç—á–∏–∫**: –í—Å–µ–≥–æ RAGAS –æ—Ü–µ–Ω–æ–∫

```promql
sum(rag_quality_interactions_total{interaction_type="ragas_evaluation"})
```

#### 7. Total User Feedback
**–°—á–µ—Ç—á–∏–∫**: –í—Å–µ–≥–æ –æ—Ü–µ–Ω–æ–∫ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```promql
sum(rag_quality_interactions_total{interaction_type="user_feedback"})
```

#### 8. User Satisfaction Rate
**–ü—Ä–æ—Ü–µ–Ω—Ç**: –î–æ–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫

```promql
user_satisfaction_rate * 100
```

#### 9. Avg Evaluation Time
**–í—Ä–µ–º—è**: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ü–µ–Ω–∫–∏

```promql
avg(quality_evaluation_duration_seconds)
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (Charts)

#### 10. User Feedback Distribution
**–¢–∏–ø**: Pie Chart

**–°–µ–≥–º–µ–Ω—Ç—ã**:
- üëç Positive (–∑–µ–ª–µ–Ω—ã–π)
- üëé Negative (–∫—Ä–∞—Å–Ω—ã–π)
- ‚ö™ No Feedback (—Å–µ—Ä—ã–π)

```promql
sum by (feedback_type) (rag_quality_interactions_total{interaction_type="user_feedback"})
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Dashboard

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω**:
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –ü–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
- –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä: 5m, 15m, 1h, 6h, 12h, 24h, 7d, 30d
- –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø–µ—Ä–∏–æ–¥: –æ—Ç-–¥–æ

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**:
- –ß–∞—Å—Ç–æ—Ç–∞: 30 —Å–µ–∫—É–Ω–¥ (auto-refresh)
- –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª

**Timezone**:
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: Browser time
- –û–ø—Ü–∏–∏: UTC, Local

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (Variables)

Dashboard –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã:

```
$channel = telegram | api | web | all
$interaction_type = ragas_evaluation | user_feedback | all
$time_range = 1h | 6h | 24h | 7d
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: Dropdown –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –¥–∞—à–±–æ—Ä–¥–∞

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞–Ω–µ–ª–µ–π**:
1. Edit (–∏–∫–æ–Ω–∫–∞ –∫–∞—Ä–∞–Ω–¥–∞—à–∞ –Ω–∞ –ø–∞–Ω–µ–ª–∏)
2. –ò–∑–º–µ–Ω–∏—Ç–µ PromQL query
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
4. Save

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª–µ–π**:
1. Dashboard settings (‚öôÔ∏è) ‚Üí Add panel
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø (Time Series, Stat, Gauge, etc.)
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ query –∏ visualization
4. Save

---

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### RAGAS –ú–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ß—Ç–æ –∏–∑–º–µ—Ä—è–µ—Ç | –î–∏–∞–ø–∞–∑–æ–Ω | –•–æ—Ä–æ—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|--------------|----------|------------------|
| **Faithfulness** | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç–≤–µ—Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É | 0.0 - 1.0 | > 0.7 |
| **Context Precision** | –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ | 0.0 - 1.0 | > 0.6 |
| **Answer Relevancy** | –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ –∑–∞–ø—Ä–æ—Å—É | 0.0 - 1.0 | > 0.8 |

**–ü—Ä–∏–º–µ—Ä—ã**:
- **Faithfulness 0.9**: –û—Ç–≤–µ—Ç –Ω–∞ 90% –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ (—Ö–æ—Ä–æ—à–æ)
- **Context Precision 0.5**: –ü–æ–ª–æ–≤–∏–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∞ (—Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è)
- **Answer Relevancy 0.95**: –û—Ç–≤–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å

### User Feedback

| –¢–∏–ø | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è |
|-----|----------|---------------|
| üëç **Positive** | User –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É "–ø–æ–ª–µ–∑–Ω–æ" | –û—Ç–≤–µ—Ç –ø–æ–º–æ–≥ —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É |
| üëé **Negative** | User –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É "–Ω–µ –ø–æ–º–æ–≥–ª–æ" | –û—Ç–≤–µ—Ç –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏–ª –∑–∞–ø—Ä–æ—Å |
| ‚ö™ **No Feedback** | User –Ω–µ –æ—Ü–µ–Ω–∏–ª | –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |

**User Satisfaction Rate** = Positive / (Positive + Negative)

### Combined Quality Score

–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ + –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∏–¥–±–µ–∫

| –î–∏–∞–ø–∞–∑–æ–Ω | –û—Ü–µ–Ω–∫–∞ | –î–µ–π—Å—Ç–≤–∏—è |
|----------|--------|----------|
| **> 0.8** | üü¢ –û—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å |
| **0.6 - 0.8** | üü° –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ | –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ç—Ä–µ–Ω–¥—ã |
| **< 0.6** | üî¥ –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è | –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è |

---

## –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã

**1. Low Quality Score**
```promql
rag_combined_quality_score < 0.6 for 15m
```
**Severity**: Critical
**–î–µ–π—Å—Ç–≤–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

**2. High Evaluation Time**
```promql
avg(quality_evaluation_duration_seconds) > 10 for 10m
```
**Severity**: Warning
**–î–µ–π—Å—Ç–≤–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å RAGAS

**3. Low User Satisfaction**
```promql
user_satisfaction_rate < 0.5 for 30m
```
**Severity**: Warning
**–î–µ–π—Å—Ç–≤–∏–µ**: –ê–Ω–∞–ª–∏–∑ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤, —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤

**–ß–µ—Ä–µ–∑ Grafana UI**:
1. Alerting ‚Üí Alert rules ‚Üí New alert rule
2. Query: –≤—Å—Ç–∞–≤—å—Ç–µ PromQL –≤—ã—à–µ
3. Condition: –Ω–∞–ø—Ä–∏–º–µ—Ä, `< 0.6`
4. Notifications: Slack/Email/Webhook
5. Save

**–ü—Ä–∏–º–µ—Ä Slack webhook**:
```
https://hooks.slack.com/services/YOUR/WEBHOOK/URL
Message: Quality score dropped to {{ $value }}
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### 1. "No data points" –≤ –¥–∞—à–±–æ—Ä–¥–µ

**–°–∏–º–ø—Ç–æ–º—ã**: –ü–∞–Ω–µ–ª–∏ –ø—É—Å—Ç—ã–µ –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç "No data"

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ RAG API
curl http://localhost:9000/metrics | grep ragas

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Prometheus
curl http://localhost:9090/api/v1/query?query=ragas_score

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ targets
open http://localhost:9090/targets
```

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ RAG API –∑–∞–ø—É—â–µ–Ω: `python wsgi.py`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   ENABLE_RAGAS_EVALUATION=true
   QUALITY_DB_ENABLED=true
   ```
3. –°–¥–µ–ª–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–∏—Å—Ç–µ–º–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 30-60 —Å–µ–∫—É–Ω–¥ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 2. "Metrics not updating"

**–°–∏–º–ø—Ç–æ–º—ã**: –î–∞–Ω–Ω—ã–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ, –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã**:
- RAG API –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- Prometheus –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏
- Auto-refresh –æ—Ç–∫–ª—é—á–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ API
tail -f logs/app.log | grep -i quality

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Prometheus scraping
docker logs rag-prometheus --tail 50

# –í Grafana: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ auto-refresh (–ø—Ä–∞–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª)
```

### 3. "Dashboard not loading"

**–°–∏–º–ø—Ç–æ–º—ã**: Grafana –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–ª–∏ –¥–∞—à–±–æ—Ä–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å Grafana
docker ps | grep grafana

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
docker restart rag-grafana

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker logs rag-grafana

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç
curl http://localhost:8080/api/health
```

### 4. "Authentication failed"

**–°–∏–º–ø—Ç–æ–º—ã**: –ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ Grafana

**–†–µ—à–µ–Ω–∏–µ**:
- **Login**: admin
- **Password**: admin123 (–Ω–µ –ø—Ä–æ—Å—Ç–æ admin!)
- –ï—Å–ª–∏ –∑–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å: —Å–±—Ä–æ—Å—å—Ç–µ —á–µ—Ä–µ–∑ docker-compose

### 5. "Query timeout"

**–°–∏–º–ø—Ç–æ–º—ã**: –ü–∞–Ω–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç timeout –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –£–º–µ–Ω—å—à–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω (—Å 30d –¥–æ 1h)
# –ò–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ queries (–¥–æ–±–∞–≤—å—Ç–µ rate/avg)
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
RAG API (:9000/metrics)
    ‚Üì —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏
Prometheus (:9090)
    ‚Üì —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å retention 200h
Grafana (:8080)
    ‚Üì –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ PromQL
Quality Dashboard
```

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | URL | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----|------------|
| **RAG API** | http://localhost:9000 | –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ quality |
| **Prometheus** | http://localhost:9090 | –•—Ä–∞–Ω–µ–Ω–∏–µ time-series |
| **Quality DB** | data/quality_interactions.db | SQLite —Å –∏—Å—Ç–æ—Ä–∏–µ–π |
| **Grafana** | http://localhost:8080 | Visualization |

### –ú–µ—Ç—Ä–∏–∫–∏ Quality

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | Labels | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|--------|----------|
| `ragas_score` | Gauge | metric_type | RAGAS –º–µ—Ç—Ä–∏–∫–∏ (0-1) |
| `user_satisfaction_rate` | Gauge | - | User feedback rate |
| `rag_quality_interactions_total` | Counter | interaction_type, channel | –°—á–µ—Ç—á–∏–∫ –æ—Ü–µ–Ω–æ–∫ |
| `quality_evaluation_duration_seconds` | Histogram | evaluation_type | –í—Ä–µ–º—è –æ—Ü–µ–Ω–∫–∏ |
| `rag_combined_quality_score` | Gauge | period | –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ |

### PromQL –ü—Ä–∏–º–µ—Ä—ã

**–°—Ä–µ–¥–Ω–∏–π RAGAS score –∑–∞ —á–∞—Å**:
```promql
avg_over_time(ragas_score{metric_type="overall"}[1h])
```

**User satisfaction trend**:
```promql
rate(rag_quality_interactions_total{interaction_type="user_feedback", feedback_type="positive"}[5m])
/
rate(rag_quality_interactions_total{interaction_type="user_feedback"}[5m])
```

**Quality –ø–æ –∫–∞–Ω–∞–ª–∞–º**:
```promql
avg(rag_combined_quality_score) by (channel)
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ |
|----------|----------|-----------|
| **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª–µ–π** | 30 —Å–µ–∫ | Dashboard settings |
| **Prometheus scraping** | 5 —Å–µ–∫ | prometheus.yml |
| **Data retention** | 200 —á–∞—Å–æ–≤ | Prometheus config |
| **Max throughput** | 1000 interactions/hour | Quality system |

### Storage

**Prometheus**:
- –§–æ—Ä–º–∞—Ç: Time-series database (TSDB)
- –†–∞–∑–º–µ—Ä: ~10MB –Ω–∞ –¥–µ–Ω—å –º–µ—Ç—Ä–∏–∫
- –°–∂–∞—Ç–∏–µ: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ

**Quality DB**:
- –§–æ—Ä–º–∞—Ç: SQLite
- –†–∞–∑–º–µ—Ä: ~1MB –Ω–∞ 1000 interactions
- Retention: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è

---

## üìö –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [RAGAS Quality System](ragas_quality_system.md) - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∫–∞—á–µ—Å—Ç–≤–∞
- [Monitoring Setup](monitoring_setup.md) - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- [Monitoring Quick Start](monitoring_quickstart.md) - –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
- [Architecture](architecture.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ RAG —Å–∏—Å—Ç–µ–º—ã

### –í–Ω–µ—à–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã

- [Grafana Documentation](https://grafana.com/docs/)
- [PromQL Basics](https://prometheus.io/docs/prometheus/latest/querying/basics/)
- [RAGAS Framework](https://docs.ragas.io/)

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 9 –æ–∫—Ç—è–±—Ä—è 2024
**–°—Ç–∞—Ç—É—Å**: Production Ready

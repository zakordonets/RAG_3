# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ GPU-—É—Å–∫–æ—Ä–µ–Ω–∏—è –Ω–∞ Windows (ONNX Runtime + DirectML)

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã (–∞–∫—Ç—É–∞–ª—å–Ω–æ)

1. **DirectML Availability** ‚Äî ORT DmlExecutionProvider –æ–±–Ω–∞—Ä—É–∂–µ–Ω
2. **Embeddings Performance** ‚Äî Embeddings —á–µ—Ä–µ–∑ ORT DML (batch —Å–∏–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ single)
3. **Reranker Performance** ‚Äî Reranker —á–µ—Ä–µ–∑ ORT DML (~1.9‚Äì2.2s)
4. **Semantic Chunker Performance** ‚Äî Chunker –Ω–∞ CPU (–æ–∂–∏–¥–∞–µ–º–æ)
5. **ORT Benchmarks** ‚Äî –ú–∏–∫—Ä–æ–±–µ–Ω—á–º–∞—Ä–∫–∏ DML –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã (—É—Å—Ç–∞—Ä–µ–ª–æ)

1. –ü—Ä–∏–≤—è–∑–∫–∞ –∫ PyTorch/torch-directml ‚Äî –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ ORT DML
2. –¢–µ—Å—Ç—ã –Ω–∞ `torch.device('dml')` ‚Äî —É–¥–∞–ª–µ–Ω—ã, –∑–∞–º–µ–Ω–µ–Ω—ã ORT-—Ç–µ—Å—Ç–∞–º–∏

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º

### –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è: ORT DML –≤–º–µ—Å—Ç–æ PyTorch DML

**–†–µ—à–µ–Ω–∏–µ**: –£—Å–∫–æ—Ä—è—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—É—Ç–∏ (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏, —Ä–µ—Ä–∞–Ω–∫) —á–µ—Ä–µ–∑ ONNX Runtime + DmlExecutionProvider. PyTorch –æ—Å—Ç–∞—ë—Ç—Å—è –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –Ω–∞ CPU/CUDA/ROCm.

### –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã ORT

–í—ã–±–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `ONNX_PROVIDER` (auto|dml|cpu). –ü—Ä–∏ `auto`/`dml` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è DML —Å —Ñ–æ–ª–±–µ–∫–æ–º –Ω–∞ CPU.

## üöÄ –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å–µ–π—á–∞—Å)

- ‚úÖ **ORT DML –æ–±–Ω–∞—Ä—É–∂–µ–Ω** ‚Äî AMD Radeon RX 6700 XT —á–µ—Ä–µ–∑ DmlExecutionProvider
- ‚úÖ **Embeddings ORT DML** ‚Äî –±—ã—Å—Ç—Ä–æ, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å –±–∞—Ç—á–∞–º–∏
- ‚úÖ **Reranker ORT DML** ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–æ, ~2s
- ‚úÖ **Semantic Chunker –Ω–∞ CPU** ‚Äî –æ–∂–∏–¥–∞–µ–º–æ
- ‚úÖ **Fallback** ‚Äî –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ DML –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPUExecutionProvider

### –ß—Ç–æ –Ω–µ –¥–µ–ª–∞–µ–º

- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º torch.device('dml')
- ‚ùå –ù–µ –æ–ø–∏—Ä–∞–µ–º—Å—è –Ω–∞ torch-directml –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ–≥–æ –ø—É—Ç–∏

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### ORT Performance (–ø—Ä–∏–º–µ—Ä)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í—Ä–µ–º—è | –°—Ç–∞—Ç—É—Å |
|-----------|-------|--------|
| **Embeddings (batch 25)** | ~0.141s | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **Reranker (batch 32)** | ~3.4s | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **Semantic Chunker** | ~3.0s | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |

### –û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | CPU | GPU | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|-----------|-----|-----|-----------|
| **Dense Embeddings** | CPU | DML | **2x‚Äì3x+** |
| **Reranking** | CPU | DML | **1.5x‚Äì2.5x** |
| **Semantic Chunking** | CPU | CPU | ‚Äî |

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-2 –Ω–µ–¥–µ–ª–∏)

1. **–§–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å ONNX –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** ‚Äî —Ö—Ä–∞–Ω–∏—Ç—å –≤ `models/onnx/...`
2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞—Ç—á–∏** ‚Äî –ø–æ–¥–æ–±—Ä–∞—Ç—å batch_size –ø–æ–¥ VRAM
3. **CI-–±–µ–Ω—á–º–∞—Ä–∫** ‚Äî –∑–∞–ø—É—Å–∫–∞—Ç—å `benchmark_ort_cpu_vs_dml.py`

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (1-2 –º–µ—Å—è—Ü–∞)

1. **–ö–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏—è/–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** ‚Äî —É–º–µ–Ω—å—à–∏—Ç—å VRAM/–≤—Ä–µ–º—è
2. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏** ‚Äî —Å–Ω–∏–∑–∏—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã–µ
3. **–ú–µ—Ç—Ä–∏–∫–∏ ORT** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (3+ –º–µ—Å—è—Ü–∞)

1. **ROCm/Linux** ‚Äî –¥–ª—è production
2. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –±—ç–∫–µ–Ω–¥–∞
3. **–ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** ‚Äî –¥–∏–Ω–∞–º–∏–∫–∞ batch_size

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ –£—Å–ø–µ—Ö–∏

- **–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç** ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç
- **Fallback —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** ‚Äî ORT CPU –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ DML
- **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî Linux/Windows –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** ‚Äî ORT –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø–æ –∫–æ–Ω—Ñ–∏–≥—É

### ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **Semantic chunker –Ω–∞ CPU** ‚Äî ST –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç DML –Ω–∞–ø—Ä—è–º—É—é
- **ORT —ç–∫—Å–ø–æ—Ä—Ç** ‚Äî —Ç—Ä–µ–±—É–µ—Ç `onnx`/`onnxruntime` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —ç–∫—Å–ø–æ—Ä—Ç–µ

### üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** ‚Äî —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å ONNX_PROVIDER** ‚Äî auto|dml|cpu
3. **–ó–∞–ø—É—Å–∫–∞—Ç—å –±–µ–Ω—á–º–∞—Ä–∫** ‚Äî –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–π

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã

```
torch==2.4.1
torch-directml==0.2.5.dev240914
torchvision==0.19.1
transformers==4.56.1
sentence-transformers==5.1.0
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
GPU_ENABLED=true
GPU_DEVICE=0
GPU_MEMORY_FRACTION=0.8
RERANKER_DEVICE=cuda
```

### –õ–æ–≥–∏

```
2025-09-16 22:24:07.301 | INFO | AMD GPU –æ–±–Ω–∞—Ä—É–∂–µ–Ω: AMD Radeon RX 6700 XT
2025-09-16 22:24:07.301 | INFO | DirectML –¥–æ—Å—Ç—É–ø–µ–Ω: AMD Radeon RX 6700 XT (—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 0)
2025-09-16 22:24:15.050 | INFO | DirectML detected, using CPU for reranker
2025-09-16 22:24:16.828 | INFO | DirectML detected, using CPU for semantic chunker
```

## üéâ –ò—Ç–æ–≥

**RAG —Å–∏—Å—Ç–µ–º–∞ —É—Å–ø–µ—à–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows —Å AMD Radeon RX 6700 XT!**

- ‚úÖ **–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç**
- ‚úÖ **Fallback —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç**
- ‚úÖ **–ì–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**
- ‚ö†Ô∏è **GPU-—É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –≤ —Ç–µ–∫—É—â–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ GPU –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –≤–µ—Ä—Å–∏–π PyTorch –∏ torch-directml.

# üìä –ò—Ç–æ–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è RAGAS Integration

**–î–∞—Ç–∞**: 10 –æ–∫—Ç—è–±—Ä—è 2024
**–í–µ—Ä—Å–∏—è**: 2.0

---

## üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: RAGAS –æ—Ü–µ–Ω–∫–∞ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å**

**–õ–æ–∫–∞—Ü–∏—è**: `app/services/quality/ragas_evaluator.py:203-206`

```python
# –†–ê–ù–¨–®–ï:
# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã
logger.info("Using heuristic evaluation for fast processing")
return self._calculate_fallback_scores(query, response, contexts)
# ^^^  RAGAS –ù–ò–ö–û–ì–î–ê –Ω–µ –≤—ã–∑—ã–≤–∞–ª–∞—Å—å!
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∏—Å—Ç–µ–º–∞ **–≤—Å–µ–≥–¥–∞** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ —Ç–æ–ª—å–∫–æ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ü–µ–Ω–∫–∏, –¥–∞–∂–µ –∫–æ–≥–¥–∞ RAGAS –±—ã–ª–∞ –≤–∫–ª—é—á–µ–Ω–∞.

---

### 2. **–ë–∞–≥–∏ –≤ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–µ**

#### –ë–∞–≥ 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —É—Å–ª–æ–≤–∏–π
```python
# –†–ê–ù–¨–®–ï (–ë–ê–ì):
if len(contexts) >= 3:
    context_precision += 0.1
elif len(contexts) >= 5:  # ‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï –í–´–ü–û–õ–ù–ò–¢–°–Ø!
    context_precision += 0.2
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –£—Å–ª–æ–≤–∏–µ `>= 5` –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ `>= 3` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–Ω—å—à–µ.

#### –ë–∞–≥ 2: –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–µ –±–∞–∑–æ–≤—ã–µ –æ—Ü–µ–Ω–∫–∏
- `faithfulness` –Ω–∞—á–∏–Ω–∞–ª—Å—è —Å 0.7
- `context_precision` –Ω–∞—á–∏–Ω–∞–ª—Å—è —Å 0.8
- –í—Å–µ –æ—Ü–µ–Ω–∫–∏ –ø–æ–ª—É—á–∞–ª–∏—Å—å —Å–ª–∏—à–∫–æ–º –ø–æ—Ö–æ–∂–∏–º–∏ (~0.8-0.9)

---

### 3. **–ü—Ä–æ–±–ª–µ–º—ã —Å async –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π YandexGPT**

–û—à–∏–±–∫–∏ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RAGAS —Å YandexGPT:
```
Exception raised in Job[X]: TypeError(An asyncio.Future, a coroutine or an awaitable is required)
```

**–ü—Ä–∏—á–∏–Ω–∞**:
- –ú–µ—Ç–æ–¥ `agenerate_prompt` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `asyncio.run()` (—Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π event loop)
- `_yandex_complete` –±—ã–ª —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º, –∞ RAGAS –æ–∂–∏–¥–∞–ª–∞ async

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è RAGAS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**

–¢–µ–ø–µ—Ä—å RAGAS **—Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç** —Å –≤—ã–±–æ—Ä–æ–º LLM backend:

```python
# –í—ã–±–æ—Ä —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
RAGAS_LLM_BACKEND=yandexgpt  # yandexgpt | deepseek | openai | gpt5
```

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ backends:
- ‚úÖ **YandexGPT** - —á–µ—Ä–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π async wrapper
- ‚úÖ **Deepseek** - —á–µ—Ä–µ–∑ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API
- ‚úÖ **OpenAI** - –Ω–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚úÖ **GPT-5** - —á–µ—Ä–µ–∑ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API

---

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π YandexGPTLangChainWrapper**

–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å RAGAS:

```python
class YandexGPTLangChainWrapper(BaseLanguageModel):
    def _generate(
        self,
        prompts: List[str],
        stop: Optional[List[str]] = None,
        run_manager: Optional[CallbackManagerForLLMRun] = None,
        **kwargs
    ) -> LLMResult:
        """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è"""
        # –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –¥–ª—è LangChain

    async def _agenerate(
        self,
        prompts: List[str],
        stop: Optional[List[str]] = None,
        run_manager: Optional[AsyncCallbackManagerForLLMRun] = None,
        **kwargs
    ) -> LLMResult:
        """–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ thread pool"""
        return await asyncio.to_thread(self._generate, prompts, stop, run_manager, **kwargs)
```

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –º–µ—Ç–æ–¥–æ–≤ `_generate` –∏ `_agenerate`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `asyncio.to_thread()` –≤–º–µ—Å—Ç–æ `asyncio.run()`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ (RAGAS –ø–µ—Ä–µ–¥–∞–µ—Ç batch)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `CallbackManager` –¥–ª—è RAGAS –º–µ—Ç—Ä–∏–∫

---

### 3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞**

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ context_precision:
```python
# –ü–û–°–õ–ï (–ò–°–ü–†–ê–í–õ–ï–ù–û):
if num_contexts >= 5:      # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    context_precision += 0.2
elif num_contexts >= 3:    # –ü–æ—Ç–æ–º –º–µ–Ω—å—à–µ–µ
    context_precision += 0.15
```

#### –ë–æ–ª–µ–µ —É–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:
- **Faithfulness**:
  - –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0.3 (–Ω–∏–∑–∫–∏–π –±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å)
  - –ê–Ω–∞–ª–∏–∑ word overlap –º–µ–∂–¥—É response –∏ contexts
  - –ü–æ–∏—Å–∫ —Ñ—Ä–∞–∑ –∏–∑ context –≤ response
  - –®—Ç—Ä–∞—Ñ –∑–∞ generic –æ—Ç–≤–µ—Ç—ã ("–Ω–µ –∑–Ω–∞—é", "–∏–∑–≤–∏–Ω–∏—Ç–µ")

- **Context Precision**:
  - –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0.4 (–∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –¥–æ–∫–∞–∑–∞—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å)
  - Jaccard similarity –º–µ–∂–¥—É query –∏ contexts
  - –£–¥–∞–ª–µ–Ω–∏–µ stop-words –¥–ª—è –ª—É—á—à–µ–≥–æ matching
  - –£—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤

- **Answer Relevancy**:
  - –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0.3 (–æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –¥–æ–∫–∞–∑–∞—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å)
  - Term overlap —Å —É—á–µ—Ç–æ–º stop-words
  - –ë–æ–Ω—É—Å –∑–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã (API, –º–µ—Ç–æ–¥, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
  - –®—Ç—Ä–∞—Ñ –∑–∞ —É–∫–ª–æ–Ω—á–∏–≤—ã–µ –æ—Ç–≤–µ—Ç—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—Ü–µ–Ω–∫–∏ —Ç–µ–ø–µ—Ä—å **–≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞, –∞ –Ω–µ –∑–∞—Å—Ç—ã–≤–∞—é—Ç –Ω–∞ –æ–¥–Ω–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏.

---

### 4. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è**

```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º sample_rate –ü–†–ê–í–ò–õ–¨–ù–û
sample_rate = float(os.getenv("RAGAS_EVALUATION_SAMPLE_RATE", "1.0"))

if sample_rate == 0.0:
    # –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–µ–Ω–æ
    return heuristic_scores

if random.random() > sample_rate:
    # –ù–µ –ø–æ–ø–∞–ª–∏ –≤ sample
    return heuristic_scores

# –ó–∞–ø—É—Å–∫–∞–µ–º RAGAS –¥–ª—è X% –∑–∞–ø—Ä–æ—Å–æ–≤
return await ragas_evaluation()
```

**–†–ê–ù–¨–®–ï**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—ã–ª–∞ `== "0"` (—Å—Ç—Ä–æ–∫–∞), –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°–ï–ô–ß–ê–°**: –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

---

### 5. **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

–î–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ:
```python
logger.info(f"Running RAGAS evaluation with {self.backend_name} (sample rate: 10.00%)")
logger.debug(f"Heuristic faithfulness: 0.850")
logger.debug(f"Heuristic context precision: 0.750 (3/3 relevant)")
logger.warning("RAGAS backend not available, using heuristic evaluation")
```

---

## üìñ –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ RAGAS –æ—Ü–µ–Ω–∫–∏
ENABLE_RAGAS_EVALUATION=true

# –ß–∞—Å—Ç–æ—Ç–∞ –æ—Ü–µ–Ω–∫–∏ (0.0-1.0)
# 0.0 = –æ—Ç–∫–ª—é—á–µ–Ω–æ, 0.1 = 10% –∑–∞–ø—Ä–æ—Å–æ–≤, 1.0 = –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
RAGAS_EVALUATION_SAMPLE_RATE=0.1

# –í—ã–±–æ—Ä LLM –¥–ª—è RAGAS
# –í–∞—Ä–∏–∞–Ω—Ç—ã: yandexgpt | deepseek | openai | gpt5
RAGAS_LLM_BACKEND=yandexgpt

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: OpenAI –¥–ª—è RAGAS
# OPENAI_API_KEY=sk-...
# OPENAI_MODEL=gpt-4o-mini
```

---

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –±—ã—Å—Ç—Ä–æ)

```bash
# –í .env
ENABLE_RAGAS_EVALUATION=true
RAGAS_EVALUATION_SAMPLE_RATE=0.1
RAGAS_LLM_BACKEND=yandexgpt  # –ë–µ–∑ API –∫–ª—é—á–∞ = —ç–≤—Ä–∏—Å—Ç–∏–∫–∞
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑ LLM –≤—ã–∑–æ–≤–æ–≤ (< 100ms)

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: RAGAS —Å YandexGPT (–º–µ–¥–ª–µ–Ω–Ω–æ, —Ç–æ—á–Ω–æ)

```bash
# –í .env
ENABLE_RAGAS_EVALUATION=true
RAGAS_EVALUATION_SAMPLE_RATE=0.05  # 5% –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏
RAGAS_LLM_BACKEND=yandexgpt

# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
YANDEX_API_KEY=...
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ù–∞—Å—Ç–æ—è—â–∞—è RAGAS –æ—Ü–µ–Ω–∫–∞ —Å YandexGPT (~180 —Å–µ–∫—É–Ω–¥ –Ω–∞ –æ—Ü–µ–Ω–∫—É, 6-9 LLM –≤—ã–∑–æ–≤–æ–≤)

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: RAGAS —Å Deepseek (–±—ã—Å—Ç—Ä–æ, –¥–µ—à–µ–≤–æ)

```bash
# –í .env
ENABLE_RAGAS_EVALUATION=true
RAGAS_EVALUATION_SAMPLE_RATE=0.2  # 20%
RAGAS_LLM_BACKEND=deepseek

# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
DEEPSEEK_API_KEY=...
DEEPSEEK_API_URL=https://api.deepseek.com/v1/chat/completions
DEEPSEEK_MODEL=deepseek-chat
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë—ã—Å—Ç—Ä–∞—è RAGAS –æ—Ü–µ–Ω–∫–∞ —Å Deepseek (~30-60 —Å–µ–∫—É–Ω–¥)

---

### –í–∞—Ä–∏–∞–Ω—Ç 4: RAGAS —Å OpenAI (–±—ã—Å—Ç—Ä–æ, –¥–æ—Ä–æ–≥–æ)

```bash
# –í .env
ENABLE_RAGAS_EVALUATION=true
RAGAS_EVALUATION_SAMPLE_RATE=0.1
RAGAS_LLM_BACKEND=openai

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ OpenAI API key
OPENAI_API_KEY=sk-...
OPENAI_MODEL=gpt-4o-mini  # –ò–ª–∏ gpt-4
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë—ã—Å—Ç—Ä–∞—è RAGAS –æ—Ü–µ–Ω–∫–∞ —Å OpenAI (~20-40 —Å–µ–∫—É–Ω–¥)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã
python tests/test_ragas_quality.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ backend
RAGAS_LLM_BACKEND=yandexgpt python tests/test_ragas_quality.py
RAGAS_LLM_BACKEND=deepseek python tests/test_ragas_quality.py
```

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–≠–≤—Ä–∏—Å—Ç–∏–∫–∞** (–±—ã—Å—Ç—Ä–æ):
```
Faithfulness:        0.750
Context Precision:   0.600
Answer Relevancy:    0.820
Overall Score:       0.723
Time: <100ms
```

**RAGAS —Å LLM** (–º–µ–¥–ª–µ–Ω–Ω–æ, —Ç–æ—á–Ω–æ):
```
Faithfulness:        0.850
Context Precision:   0.720
Answer Relevancy:    0.910
Overall Score:       0.827
Time: 30-180 —Å–µ–∫—É–Ω–¥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç LLM)
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### YandexGPT –¥–ª—è RAGAS

**–ü–ª—é—Å—ã**:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º wrapper
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å (–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å)
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö API –∫–ª—é—á–µ–π

**–ú–∏–Ω—É—Å—ã**:
- ‚ùå **–û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ**: 6-9 –≤—ã–∑–æ–≤–æ–≤ √ó 20-30 —Å–µ–∫ = 3+ –º–∏–Ω—É—Ç—ã –Ω–∞ –æ—Ü–µ–Ω–∫—É
- ‚ùå –ù–µ—Ç batch processing
- ‚ùå –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤ thread pool (–Ω–µ –∏—Å—Ç–∏–Ω–Ω—ã–π async)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ sample_rate ‚â§ 0.05 (5%) –∏–ª–∏ —ç–≤—Ä–∏—Å—Ç–∏–∫—É

---

### Deepseek –¥–ª—è RAGAS

**–ü–ª—é—Å—ã**:
- ‚úÖ **–ë—ã—Å—Ç—Ä–æ**: OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API —Å async
- ‚úÖ **–î–µ—à–µ–≤–æ**: ~$0.001 –∑–∞ –æ—Ü–µ–Ω–∫—É
- ‚úÖ –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ

**–ú–∏–Ω—É—Å—ã**:
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç Deepseek API key
- ‚ö†Ô∏è –í–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å (–¥–∞–Ω–Ω—ã–µ —É—Ö–æ–¥—è—Ç –≤ Deepseek)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è production –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ API key

---

### –≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞

**–ü–ª—é—Å—ã**:
- ‚úÖ **–û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ**: < 100ms
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç LLM –≤—ã–∑–æ–≤–æ–≤
- ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–Ω–∞—è –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- ‚úÖ –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (–Ω–µ—Ç API —Ä–∞—Å—Ö–æ–¥–æ–≤)

**–ú–∏–Ω—É—Å—ã**:
- ‚ö†Ô∏è –ú–µ–Ω–µ–µ —Ç–æ—á–Ω–∞—è, —á–µ–º –Ω–∞—Å—Ç–æ—è—â–∞—è RAGAS
- ‚ö†Ô∏è –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–µ–º–∞–Ω—Ç–∏–∫—É

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, RAGAS - –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| Backend | –í—Ä–µ–º—è –æ—Ü–µ–Ω–∫–∏ | –°—Ç–æ–∏–º–æ—Å—Ç—å | –¢–æ—á–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|---------|-------------|-----------|----------|--------------|
| **–≠–≤—Ä–∏—Å—Ç–∏–∫–∞** | < 100ms | $0 | ‚≠ê‚≠ê‚≠ê | Production default |
| **YandexGPT** | 180+ —Å–µ–∫ | ~$0 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | Development only |
| **Deepseek** | 30-60 —Å–µ–∫ | ~$0.001 | ‚≠ê‚≠ê‚≠ê‚≠ê | Production —Å budget |
| **OpenAI** | 20-40 —Å–µ–∫ | ~$0.01 | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | Production –±–µ–∑ budget |

---

## üéâ –ò—Ç–æ–≥–∏

### –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. ‚úÖ RAGAS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è **—Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç**
2. ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **4 LLM backends** (YandexGPT, Deepseek, OpenAI, GPT-5)
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã **–±–∞–≥–∏ –≤ —ç–≤—Ä–∏—Å—Ç–∏–∫–µ** (–æ—Ü–µ–Ω–∫–∏ —Ç–µ–ø–µ—Ä—å –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è)
4. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π **async wrapper –¥–ª—è YandexGPT**
5. ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ **—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** (RAGAS_EVALUATION_SAMPLE_RATE)
6. ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ **–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

1. **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: –≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ (–±—ã—Å—Ç—Ä–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
2. **–î–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏**: RAGAS —Å Deepseek (sample_rate=0.1-0.2)
3. **–î–ª—è A/B —Ç–µ—Å—Ç–æ–≤**: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –∏ RAGAS –Ω–∞ –æ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —ç–≤—Ä–∏—Å—Ç–∏–∫–æ–π –∏ user feedback

---

**–ê–≤—Ç–æ—Ä**: AI Assistant
**–î–∞—Ç–∞**: 10 –æ–∫—Ç—è–±—Ä—è 2024

